<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Nepaltr Pro - Secure Terminal</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>

    <style>
        :root { --bg: #060d17; --panel: #111a27; --accent: #fcc419; --up: #00c076; --down: #ff3b30; --border: #1c2735; }
        body, html { margin: 0; padding: 0; height: 100%; background: var(--bg); color: white; font-family: sans-serif; overflow: hidden; }
        
        /* --- AUTH SCREEN --- */
        #auth-screen { position: fixed; inset: 0; background: var(--bg); z-index: 20000; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px; }
        .auth-box { background: var(--panel); padding: 25px; border-radius: 15px; width: 100%; max-width: 350px; border: 1px solid var(--border); }
        .auth-input { width: 100%; padding: 12px; margin-bottom: 10px; background: #060d17; border: 1px solid var(--border); color: white; border-radius: 8px; }

        /* --- APP INTERFACE --- */
        #app-interface { display: none; flex-direction: column; height: 100vh; }
        header { display: flex; justify-content: space-between; align-items: center; padding: 0 15px; height: 60px; background: var(--panel); border-bottom: 1px solid var(--border); }
        
        /* --- WALLET HUB --- */
        .modal { position: fixed; inset: 0; background: rgba(0,0,0,0.9); display: none; z-index: 15000; justify-content: center; align-items: center; }
        .hub-box { background: var(--panel); width: 90%; max-width: 400px; border-radius: 15px; padding: 20px; text-align: center; }
        .hub-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 20px; }
        .hub-item { background: #060d17; padding: 15px; border-radius: 10px; border: 1px solid var(--border); cursor: pointer; }

        /* --- BOTTOM TRADE DOCK --- */
        .trade-dock { background: var(--panel); padding: 15px; border-top: 1px solid var(--border); }
        .btn-row { display: flex; gap: 10px; height: 50px; }
        .trade-btn { flex: 1; border: none; border-radius: 8px; color: white; font-weight: bold; font-size: 18px; }
    </style>
</head>
<body>

<div id="auth-screen">
    <div class="auth-box">
        <h2 style="color:var(--accent); text-align:center;">NEPALTR PRO</h2>
        <input type="email" id="email" class="auth-input" placeholder="Email">
        <input type="password" id="pass" class="auth-input" placeholder="Password">
        <input type="text" id="promo" class="auth-input" placeholder="Promo Code (Optional)">
        <button onclick="handleAuth('login')" class="auth-input" style="background:var(--accent); color:black; font-weight:bold;">Login</button>
        <button onclick="handleAuth('register')" style="background:transparent; border:none; color:#848e9c; width:100%; margin-top:10px;">Create Account</button>
        <p id="auth-error" style="color:var(--down); font-size:12px; text-align:center; margin-top:10px;"></p>
    </div>
</div>

<div id="app-interface">
    <header>
        <div style="font-weight:bold;">NEPALTR</div>
        <div onclick="openHub()" style="cursor:pointer; background:rgba(252,196,25,0.1); padding:5px 12px; border-radius:20px; border:1px solid var(--accent);">
            <span id="user-bal" style="color:var(--accent); font-weight:bold;">NPR 0.00</span> üëõ
        </div>
    </header>

    <div id="chart-area" style="flex:1;"><div id="tv_widget" style="height:100%;"></div></div>

    <div class="trade-dock">
        <div class="btn-row">
            <button class="trade-btn" style="background:var(--up);" onclick="alert('Call Placed')">UP</button>
            <button class="trade-btn" style="background:var(--down);" onclick="alert('Put Placed')">DOWN</button>
        </div>
    </div>
</div>

<div id="hub-modal" class="modal" onclick="closeHub(event)">
    <div class="hub-box">
        <h3 style="margin:0;">Financial Hub</h3>
        <div class="hub-grid">
            <div class="hub-item" onclick="alert('Opening Deposit...')">üí∞ Deposit</div>
            <div class="hub-item" onclick="alert('Opening Withdraw...')">üèß Withdraw</div>
            <div class="hub-item" onclick="alert('Showing History...')">üìú History</div>
            <div class="hub-item" onclick="copyReferral()">üîó Refer & Earn</div>
        </div>
        <button onclick="logout()" style="margin-top:20px; background:var(--down); color:white; border:none; padding:10px 20px; border-radius:5px;">Logout</button>
    </div>
</div>

<script src="https://s3.tradingview.com/tv.js"></script>
<script>
    const firebaseConfig = { /* Your Config Here */ };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    // --- 12 HOUR SESSION LOGIC ---
    function handleAuth(type) {
        const lastLogin = localStorage.getItem('last_login_time');
        const now = Date.now();
        
        if (lastLogin && (now - lastLogin < 12 * 60 * 60 * 1000)) {
            const remaining = Math.ceil((12 * 60 * 60 * 1000 - (now - lastLogin)) / (60 * 60 * 1000));
            document.getElementById('auth-error').innerText = `Security Lock: Try again in ${remaining} hours.`;
            return;
        }

        const email = document.getElementById('email').value;
        const pass = document.getElementById('pass').value;

        if(type === 'login') {
            auth.signInWithEmailAndPassword(email, pass).then(() => {
                localStorage.setItem('last_login_time', Date.now());
            }).catch(err => document.getElementById('auth-error').innerText = err.message);
        } else {
            auth.createUserWithEmailAndPassword(email, pass).catch(err => document.getElementById('auth-error').innerText = err.message);
        }
    }

    auth.onAuthStateChanged(user => {
        if(user) {
            document.getElementById('auth-screen').style.display = 'none';
            document.getElementById('app-interface').style.display = 'flex';
            initChart();
        } else {
            document.getElementById('auth-screen').style.display = 'flex';
            document.getElementById('app-interface').style.display = 'none';
        }
    });

    function openHub() { document.getElementById('hub-modal').style.display = 'flex'; }
    function closeHub(e) { if(e.target.className === 'modal') e.target.style.display = 'none'; }
    function logout() { auth.signOut(); }
    
    function copyReferral() {
        const link = "https://nepaltr.pro/register?ref=" + auth.currentUser.uid;
        navigator.clipboard.writeText(link);
        alert("Referral Link Copied!");
    }

    function initChart() {
        new TradingView.widget({ "autosize": true, "symbol": "BINANCE:BTCUSDT", "interval": "1", "theme": "dark", "container_id": "tv_widget" });
    }
</script>
</body>
</html>
